FROM python:3.8-slim

WORKDIR /app

COPY . .

RUN pip install Flask

# Tambahkan user non-root
RUN useradd -m vaultuser

# Buat binary yang bisa dieksploitasi untuk eskalasi privilege
RUN echo '#!/bin/bash\n/bin/bash' > /usr/local/bin/suid-bin && chmod +x /usr/local/bin/suid-bin && chmod +s /usr/local/bin/suid-bin

# Set user ke non-root
USER vaultuser

CMD ["python", "app.py"]
